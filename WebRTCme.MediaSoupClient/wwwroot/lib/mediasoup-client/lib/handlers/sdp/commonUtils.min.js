/**
 * Minified by jsDelivr using Terser v5.3.5.
 * Original file: /npm/mediasoup-client@3.6.34/lib/handlers/sdp/commonUtils.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.applyCodecParameters=exports.getCname=exports.extractDtlsParameters=exports.extractRtpCapabilities=void 0;const sdpTransform=__importStar(require("sdp-transform"));function extractRtpCapabilities({sdpObject:e}){const t=new Map,r=[];let a=!1,o=!1;for(const n of e.media){const e=n.type;switch(e){case"audio":if(a)continue;a=!0;break;case"video":if(o)continue;o=!0;break;default:continue}for(const r of n.rtp){const a={kind:e,mimeType:`${e}/${r.codec}`,preferredPayloadType:r.payload,clockRate:r.rate,channels:r.encoding,parameters:{},rtcpFeedback:[]};t.set(a.preferredPayloadType,a)}for(const e of n.fmtp||[]){const r=sdpTransform.parseParams(e.config),a=t.get(e.payload);a&&(r&&r.hasOwnProperty("profile-level-id")&&(r["profile-level-id"]=String(r["profile-level-id"])),a.parameters=r)}for(const e of n.rtcpFb||[]){const r=t.get(e.payload);if(!r)continue;const a={type:e.type,parameter:e.subtype};a.parameter||delete a.parameter,r.rtcpFeedback.push(a)}for(const t of n.ext||[]){if(t["encrypt-uri"])continue;const a={kind:e,uri:t.uri,preferredId:t.value};r.push(a)}}return{codecs:Array.from(t.values()),headerExtensions:r}}function extractDtlsParameters({sdpObject:e}){const t=(e.media||[]).find((e=>e.iceUfrag&&0!==e.port));if(!t)throw new Error("no active media section found");const r=t.fingerprint||e.fingerprint;let a;switch(t.setup){case"active":a="client";break;case"passive":a="server";break;case"actpass":a="auto"}return{role:a,fingerprints:[{algorithm:r.type,value:r.hash}]}}function getCname({offerMediaObject:e}){const t=(e.ssrcs||[]).find((e=>"cname"===e.attribute));return t?t.value:""}function applyCodecParameters({offerRtpParameters:e,answerMediaObject:t}){for(const r of e.codecs){const e=r.mimeType.toLowerCase();if("audio/opus"!==e)continue;if(!(t.rtp||[]).find((e=>e.payload===r.payloadType)))continue;t.fmtp=t.fmtp||[];let a=t.fmtp.find((e=>e.payload===r.payloadType));a||(a={payload:r.payloadType,config:""},t.fmtp.push(a));const o=sdpTransform.parseParams(a.config);switch(e){case"audio/opus":{const e=r.parameters["sprop-stereo"];void 0!==e&&(o.stereo=e?1:0);break}}a.config="";for(const e of Object.keys(o))a.config&&(a.config+=";"),a.config+=`${e}=${o[e]}`}}exports.extractRtpCapabilities=extractRtpCapabilities,exports.extractDtlsParameters=extractDtlsParameters,exports.getCname=getCname,exports.applyCodecParameters=applyCodecParameters;
//# sourceMappingURL=/sm/092bcc8c792f921027a9af4151404ce000328b7e6bcfcea047c120533846883b.map